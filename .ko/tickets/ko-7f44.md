---
id: ko-7f44
status: closed
deps: []
links: []
created: 2026-02-17T13:59:23Z
type: task
priority: 2
---
# Verbose mode (--verbose) for build/loop — stream full agent output to stdout for prompt tuning

## Problem

When a build step behaves unexpectedly (wrong ticket implemented, plan mode
entered, context not used), there's no way to see what the agent actually did.
The build artifacts capture the final output per step, but not the agent's
full reasoning — tool calls, thinking, intermediate output. Without this,
prompt tuning is guesswork.

## Design

`ko build --verbose <id>` and `ko loop --verbose` stream the agent's full
output to stdout in real time, in addition to capturing it in the build
artifacts directory.

Currently `runPromptNode` captures output via `cmd.Output()`. In verbose
mode, wire stdout and stderr through to the terminal (via `io.TeeReader`
or `cmd.Stdout = io.MultiWriter(capture, os.Stdout)`).

```bash
# Watch a single build in detail
ko build --verbose exo-v7am

# Watch the loop with full agent output
ko loop --verbose
```

### Output formatting

Prefix agent output lines with the node name so it's clear which step is
talking:

```
[triage] Evaluating ticket exo-v7am...
[triage] This ticket has a detailed spec with acceptance criteria...
[implement] Reading cmd/exo-bridge/claude.go...
[implement] > **Read** `/home/dev/Projects/exocortex/cmd/exo-bridge/claude.go`
```

### Shorthand

`-v` as alias for `--verbose`.

## Acceptance Criteria

- [ ] `ko build -v <id>` streams full agent output to stdout in real time
- [ ] `ko loop -v` does the same for each ticket in the loop
- [ ] Output is prefixed with the node name for readability
- [ ] Build artifacts are still captured (verbose is additive, not replacing)
- [ ] Non-verbose mode is unchanged (default behavior preserved)
