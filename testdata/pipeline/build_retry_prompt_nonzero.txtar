# Prompt stage that exits non-zero (no signal) gets retried
# fake-llm fails on first call, succeeds on second
chmod 755 fake-llm
exec ko build ko-a001
stdout 'SUCCEED'
exec ko show ko-a001
stdout 'status: closed'

-- .tickets/ko-a001.md --
---
id: ko-a001
status: open
deps: []
links: []
created: 2026-01-01T00:00:00Z
type: task
priority: 2
---
# Retry test
-- .ko/pipeline.yml --
command: ./fake-llm
max_retries: 1
stages:
  - name: implement
    prompt: implement.md
-- .ko/prompts/implement.md --
Implement.
-- fake-llm --
#!/bin/sh
# Fail on first call, succeed on second
MARKER=".llm_called"
if [ ! -f "$MARKER" ]; then
    touch "$MARKER"
    exit 1
fi
echo "Done."
